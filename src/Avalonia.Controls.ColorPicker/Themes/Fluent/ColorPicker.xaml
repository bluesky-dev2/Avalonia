<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="using:Avalonia.Controls"
        xmlns:converters="using:Avalonia.Controls.Converters"
        x:CompileBindings="False">

  <Styles.Resources>
    <converters:ToBrushConverter x:Key="ToBrush" />
    <converters:CornerRadiusFilterConverter x:Key="LeftCornerRadiusFilterConverter" Filter="TopLeft, BottomLeft"/>
  </Styles.Resources>

  <Style Selector="ColorPicker">
    <Setter Property="CornerRadius" Value="{DynamicResource ControlCornerRadius}" />
    <Setter Property="Height" Value="32" />
    <Setter Property="Width" Value="64" />
    <Setter Property="MinWidth" Value="64" />
    <Setter Property="Palette">
      <local:FluentColorPalette />
    </Setter>
    <Setter Property="Template">
      <ControlTemplate>
        <DropDownButton CornerRadius="{TemplateBinding CornerRadius}"
                        Height="{TemplateBinding Height}"
                        Width="{TemplateBinding Width}"
                        HorizontalContentAlignment="Stretch"
                        VerticalContentAlignment="Stretch"
                        Padding="0,0,10,0"
                        UseLayoutRounding="False">
          <DropDownButton.Styles>
            <Style Selector="FlyoutPresenter.NoPadding">
              <Setter Property="Padding" Value="0" />
            </Style>
          </DropDownButton.Styles>
          <DropDownButton.Content>
            <!-- Preview color -->
            <Panel>
              <Border Background="{StaticResource CheckeredBackgroundBrush}"
                      CornerRadius="{TemplateBinding CornerRadius, Converter={StaticResource LeftCornerRadiusFilterConverter}}"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      Margin="1,1,0,1" />
              <Border Background="{TemplateBinding HsvColor, Converter={StaticResource ToBrush}}"
                      CornerRadius="{TemplateBinding CornerRadius, Converter={StaticResource LeftCornerRadiusFilterConverter}}"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      Margin="1,1,0,1" />
            </Panel>
          </DropDownButton.Content>
          <DropDownButton.Flyout>
            <Flyout FlyoutPresenterClasses="NoPadding">
              <ColorView x:Name="FlyoutColorView"
                         Color="{Binding $parent[ColorPicker].Color, Mode=TwoWay}"
                         ColorModel="{Binding $parent[ColorPicker].ColorModel, Mode=TwoWay}"
                         ColorSpectrumComponents="{Binding $parent[ColorPicker].ColorSpectrumComponents}"
                         ColorSpectrumShape="{Binding $parent[ColorPicker].ColorSpectrumShape}"
                         HsvColor="{Binding $parent[ColorPicker].HsvColor, Mode=TwoWay}"
                         IsAlphaEnabled="{Binding $parent[ColorPicker].IsAlphaEnabled}"
                         IsAlphaVisible="{Binding $parent[ColorPicker].IsAlphaVisible}"
                         IsColorComponentsVisible="{Binding $parent[ColorPicker].IsColorComponentsVisible}"
                         IsColorPaletteVisible="{Binding $parent[ColorPicker].IsColorPaletteVisible}"
                         IsColorPreviewVisible="{Binding $parent[ColorPicker].IsColorPreviewVisible}"
                         IsColorSpectrumVisible="{Binding $parent[ColorPicker].IsColorSpectrumVisible}"
                         IsColorSpectrumSliderVisible="{Binding $parent[ColorPicker].IsColorSpectrumSliderVisible}"
                         IsComponentTextInputVisible="{Binding $parent[ColorPicker].IsComponentTextInputVisible}"
                         IsHexInputVisible="{Binding $parent[ColorPicker].IsHexInputVisible}"
                         MaxHue="{Binding $parent[ColorPicker].MaxHue}"
                         MaxSaturation="{Binding $parent[ColorPicker].MaxSaturation}"
                         MaxValue="{Binding $parent[ColorPicker].MaxValue}"
                         MinHue="{Binding $parent[ColorPicker].MinHue}"
                         MinSaturation="{Binding $parent[ColorPicker].MinSaturation}"
                         MinValue="{Binding $parent[ColorPicker].MinValue}"
                         PaletteColors="{Binding $parent[ColorPicker].PaletteColors}"
                         PaletteColumnCount="{Binding $parent[ColorPicker].PaletteColumnCount}"
                         Palette="{Binding $parent[ColorPicker].Palette}"
                         SelectedIndex="{Binding $parent[ColorPicker].SelectedIndex, Mode=TwoWay}"
                         ShowAccentColors="{Binding $parent[ColorPicker].ShowAccentColors}" />
            </Flyout>
          </DropDownButton.Flyout>
        </DropDownButton>
      </ControlTemplate>
    </Setter>
  </Style>

</Styles>
